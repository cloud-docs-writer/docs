# Репликация и отказоустойчивость

{{ mrd-name }} использует стандартную репликацию Redis и реализует высокую доступность данных в кластере с помощью Redis Sentinel.


## Репликация {#replication}

В кластерах {{ mrd-name }} используется асинхронная репликация: результат запроса на запись информации отражается на хосте-мастере, который после этого отправляет данные на реплики кластера. Процесс репликации никак не отражается на доступности мастера, но может прерывать доступность реплик при загрузке новых данных в память (до нескольких секунд для больших баз данных).

Из-за асинхронности репликации данные на репликах могут быть неактуальными: пока реплика обрабатывает обновления, полученные от мастера, она продолжает отвечать на запросы уже имеющимися данными (выставлен параметр [replica-serve-stale-data yes](http://download.redis.io/redis-stable/redis.conf)).

Из-за ограниченных ресурсов хосты классов **b1.nano** и **b1.small** не реплицируются. 

Подробнее о том, как организована репликация в {{ RD }}, читайте в [документации СУБД](https://redis.io/topics/replication).


## Отказоустойчивость {#availability}

Высокая доступность данных в кластере реализована с помощью Redis Sentinel: в кластере из как минимум 3 хостов сервисы Sentinel автоматически управляют выбором мастера и конфигурацией реплик.

Чтобы принимать решения о работе кластера, необходима работоспособность большинства сервисов Sentinel. Поэтому используя {{ mrd-name }}, экономичнее разворачивать кластеры с нечетным количеством хостов. Например, кластер с 3 хостами может потерять 1 хост и продолжить работу, но кластер с 4 хостами также может потерять не более 1 хоста — при потере второго хоста оставшихся экземпляров Sentinel не хватит, чтобы выбрать новый мастер.

Кластер из 2 хостов не обеспечивает полной отказоустойчивости по той же причине: одного из двух экземпляров Sentinel не хватит для того, чтобы назначить один хост мастером, если другой отказал. В этой ситуации кластер может обрабатывать только операции чтения.

Владельцу кластера {{ mrd-name }} недоступна настройка сервисов Sentinel, но доступно чтение предоставляемой ими информации. Подробнее о Sentinel читайте в [документации СУБД](https://redis.io/topics/sentinel).

